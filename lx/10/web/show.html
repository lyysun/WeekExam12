<!DOCTYPE html>
<html lang="en">
<head>
	<meta charset="UTF-8">
	<title>Document</title>
	<style type="text/css">
	  td{
	  	text-align: center;
	  }
	

	 </style>
 <link href="http://libs.baidu.com/bootstrap/3.0.3/css/bootstrap.min.css" rel="stylesheet">
<script src="http://libs.baidu.com/jquery/2.0.0/jquery.min.js"></script>
<script src="http://libs.baidu.com/bootstrap/3.0.3/js/bootstrap.min.js"></script>
</head>
<body>

	

  <h3><a href="add.html">添加</a></h3>
	<table class="table table-striped">
	   <thead>
           
			<tr>
				<td>Id</td>
				<td>标题</td>
				<td>内容</td>
				<td>作者</td>
				<td>数量</td>
				<td>新闻类型</td>
				<td>操作</td>
			</tr>
		</thead>
        <!-- 放内容 -->
		<tbody>
				
		</tbody>
	     <!-- 放页码 -->
		 <tfoot>
		     	
		</tfoot>
	 </table>


</body>
<script type="text/javascript" src="jquery-1.8.3.js"></script>
<script type="text/javascript">
	//显示页面时 自动加载页面
	$(function(){
           //调用封装的 页码为第一页
           show(1);
    
	})

	function show(p){
		 $.ajax({
             url:"http://127.0.0.1/zhuanx2.5/lx/10/api/user.php",
             type:"get",
             data:{p:p},
             dataType:"json",
             success:function(e){
             	// console.log(e);
                  var str='';
                  //循环展示数据
                  $.each(e.data.data.data,function(k,v){
                       str+='<tr class="id'+v.id+'">'
                       str+='<td>'+v.id+'</td>'
                       str+='<td>'+v.title+'</td>'
                       str+='<td>'+v.nr+'</td>'
                       str+='<td>'+v.zz+'</td>'
                       str+='<td>'+v.num+'</td>'
                       str+='<td>'+v.name+'</td>'
                       str+='<td><a href="javascrpit:;" onclick="del('+v.id+')" >删除</a></td>'
                       str+='</tr>'
                      
                  })
                  //展示页码
                     var p='';
                   for (var i =1; i <=e.data.data.sumye ; i++) {
                       //每一次点击页码时 从新调用封装的 函数 show(p) （）里面放上页码
                       p+='<a href="#" onclick="show('+i+')">&nbsp;'+i+'</a>'
                   
                   };

                  $("tbody").html(str);//放展示的数据
                  $("tfoot").html(p);//放页码

             }

         })
	}


	function del(id){

		$.ajax({
			url:"http://127.0.0.1/zhuanx2.5/lx/10/api/user.php?id="+id,
			type:"DELETE",
             dataType:"json",
			success:function(e){
				if(e.data.code==200){
					$(".id"+id).remove();
					show(1);//调用展示函数show()  删除后再次补齐展示数据
				}
			}
		})
	}
</script>
</html>